## LDAP Operations

Create the Organization, Organizational Unit and Users

#### Root
```mermaid
flowchart TD
    A[dc=com]
```
## Add Organization
Created the organization file [single-node/conf/ldifs/1.o-containertalks.ldif](https://github.com/jinnabaalu/openldap-tutorial/blob/main/single-node/conf/ldifs/1.o-containertalks.ldif) mounted to the container `/ldifs/1.o-containertalks.ldif`

#### Root, Organization
```mermaid
flowchart TD
    A[dc=com] --> B[dc=containertalks,dc=com]
```
#### Add
```bash
$ docker exec -it openldap bash

$ ldapadd -x -D "cn=admin,dc=containertalks,dc=com" -W -f /ldifs/1.o-containertalks.ldif 
Enter LDAP Password: 
# OUTPUT
adding new entry "dc=containertalks,dc=com"
```

#### Search 
```bash
$ ldapsearch -x -LLL -D "cn=admin,dc=containertalks,dc=com" -W -b "dc=containertalks,dc=com" "(objectClass=*)"
Enter LDAP Password: 

# OUTPUT
dn: dc=containertalks,dc=com
objectClass: top
objectClass: dcObject
objectClass: organization
o: Containertalks Inc
dc: containertalks
```
## Add Branch (Organizational Unit)

Add the Organizational Unit file [single-node/conf/ldifs/2.ou-finance.ldif](https://github.com/jinnabaalu/openldap-tutorial/blob/main/single-node/conf/ldifs/2.1.ou-finance.ldif ) mounted to the container `/ldifs/2.1.ou-finance.ldif`

Add the Organizational Unit file [single-node/conf/ldifs/2.ou-administration.ldif](https://github.com/jinnabaalu/openldap-tutorial/blob/main/single-node/conf/ldifs/2.2.ou-administration.ldif ) mounted to the container `/ldifs/2.2.ou-administration.ldif`

#### Root, Organization, Branch
``
```mermaid
flowchart TD
    A[dc=com] --> B[dc=containertalks,dc=com]
    B --> C[ou:finance]
    B --> D[ou:administration]
```
#### Add
```bash
$ docker exec -it openldap bash

$ ldapadd -x -D "cn=admin,dc=containertalks,dc=com" -W -f /ldifs/2.ou-finance.ldif 

$ ldapadd -x -D "cn=admin,dc=containertalks,dc=com" -W -f /ldifs/2.ou-administration.ldif
Enter LDAP Password: 
# OUTPUT
adding new entry "ou=finance,dc=containertalks,dc=com"
```
#### Search 
```bash
$ ldapsearch -x -LLL -D "cn=admin,dc=containertalks,dc=com" -W -b "dc=containertalks,dc=com" "(objectClass=organizationalUnit)"
Enter LDAP Password: 
# OUTPUT
dn: ou=finance,dc=containertalks,dc=com
objectClass: top
objectClass: organizationalUnit
ou: finance

dn: ou=administration,dc=containertalks,dc=com
objectClass: top
objectClass: organizationalUnit
ou: administration
```

## Add Users
```mermaid
flowchart TD
    A[dc=com] --> B[dc=containertalks,dc=com]
    B --> C[ou:finance]
    B --> D[ou:administration]
    C --> E[cn=jinnabalu,ou=finance,dc=containertalks,dc=com]
    D --> F[cn=admin,ou=administration,dc=containertalks,dc=com]
```
#### Add
```bash
$ docker exec -it openldap bash

$ ldapadd -x -D "cn=admin,dc=containertalks,dc=com" -W -f /ldifs/3.u-jinnabalu.ldif 
Enter LDAP Password: 
# OUTPUT
adding new entry "cn=jinnabalu,ou=finance,dc=containertalks,dc=com"
```
#### Search 
```bash
$ ldapsearch -x -LLL -D "cn=admin,dc=containertalks,dc=com" -W -b "dc=containertalks,dc=com" "(objectClass=*)"
Enter LDAP Password: 

# OUTPUT
dn: dc=containertalks,dc=com
objectClass: top
objectClass: dcObject
objectClass: organization
o: Containertalks Inc
dc: containertalks

dn: ou=finance,dc=containertalks,dc=com
objectClass: top
objectClass: organizationalUnit
ou: finance

dn: cn=jinnabalu,ou=finance,dc=containertalks,dc=com
objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: inetOrgPerson
cn: jinnabalu
sn: jinnabalu
uid: jinnabalu
userPassword:: <PASSWORD>
```
## Add Groups
```mermaid
flowchart TD
    A[dc=com] --> B[dc=containertalks,dc=com]
    B --> C[ou:finance]
    B --> D[ou:administration]
    C --> E[cn=jinnabalu,ou=finance,dc=containertalks,dc=com]
    D --> F[cn=admin,ou=administration,dc=containertalks,dc=com]
    E --> G[cn=finance-users,ou=finance,dc=containertalks,dc=com]
    F --> H[cn=admin-users,ou=administration,dc=containertalks,dc=com]
```
#### Add
```bash
$ docker exec -it openldap bash

$ ldapadd -x -D "cn=admin,dc=containertalks,dc=com" -W -f /ldifs/4.g-finance-users.ldif 
Enter LDAP Password: 
# OUTPUT
adding new entry "cn=finance-users,ou=finance,dc=containertalks,dc=com"
```
#### Search 
```bash
$ ldapsearch -x -LLL -D "cn=admin,dc=containertalks,dc=com" -W -b "dc=containertalks,dc=com" "(objectClass=*)"
Enter LDAP Password: 

# OUTPUT
dn: dc=containertalks,dc=com
objectClass: top
objectClass: dcObject
objectClass: organization
o: Containertalks Inc
dc: containertalks
#### Search
**Create the files for adding two new branches**

- `add_ou_finance.ldif`
```bash file=add_ou_finance.ldif
dn: ou=hr,dc=jinnabalu,dc=com
objectClass: organizationalUnit
ou: hr
```
- `add_ou_hr.ldif`
```bash
dn: ou=hr,dc=jinnabalu,dc=com
objectClass: organizationalUnit
ou: hr
```

**Add file to the ldap **
```bash
ldapadd -H ldap://localhost:389 -x -D "cn=admin,dc=jinnabalu,dc=com" -W -f add_ou_finance.ldif
# OUTPUT: Enter LDAP Password: 
adding new entry "ou=finance,dc=jinnabalu,dc=com"

ldapadd -H ldap://localhost:389 -x -D "cn=admin,dc=jinnabalu,dc=com" -W -f add_ou_hr.ldif
# OUTPUT
Enter LDAP Password: 
adding new entry "ou=hr,dc=jinnabalu,dc=com"
```
**Validate**
```bash
ldapsearch -H ldap://localhost:389 -x -D "cn=admin,dc=jinnabalu,dc=com" -W -b "dc=jinnabalu,dc=com" "(objectClass=organizationalUnit)" -LLL
# OUTPUT
Enter LDAP Password: 
dn: ou=finance,dc=jinnabalu,dc=com
objectClass: organizationalUnit
ou: finance

dn: ou=hr,dc=jinnabalu,dc=com
objectClass: organizationalUnit
ou: hr
```


